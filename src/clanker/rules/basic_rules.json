[
  {
    "id": "RULE-SSH-001",
    "match": {
      "port": 22,
      "service_name": "OpenSSH",
      "version_contains": "7.2"
    },
    "cve": ["CVE-2016-0777"],
    "severity": "high",
    "description": "OpenSSH 7.2 is outdated and susceptible to multiple info-leak issues."
  },
  {
    "id": "RULE-RDP-001",
    "match": {
      "port": 3389,
      "service_name": "ms-wbt-server"
    },
    "cve": ["CVE-2019-0708"],
    "severity": "critical",
    "description": "Check BlueKeep exposure when RDP is accessible from broad networks."
  },
  {
    "id": "RULE-HTTP-001",
    "match": {
      "port": 80,
      "service_name": "http",
      "version_contains": "Apache/2.2"
    },
    "cve": ["CVE-2011-3368"],
    "severity": "medium",
    "description": "Old Apache 2.2 builds allow reverse-proxy bypass."
  },
  {
    "id": "RULE-REDIS-UNAUTH",
    "match": { "port": 6379, "service_name": "redis" },
    "cve": [],
    "severity": "medium",
    "description": "Redis instance appears accessible without authentication; restrict access or enable ACLs."
  },
  {
    "id": "RULE-MEMCACHED-OPEN",
    "match": { "port": 11211, "service_name": "memcached" },
    "cve": [],
    "severity": "medium",
    "description": "Memcached is accessible on the network; restrict to localhost or trusted networks to avoid amplification/abuse."
  },
  {
    "id": "RULE-MSSQL-UNENCRYPTED",
    "match": { "port": 1433, "service_name": "mssql" },
    "cve": [],
    "severity": "medium",
    "description": "SQL Server endpoint reachable without enforced encryption; enable TLS and restrict exposure."
  },
  {
    "id": "RULE-LDAP-EXPOSED",
    "match": { "service_name": "ldap" },
    "cve": [],
    "severity": "medium",
    "description": "LDAP endpoint exposed; ensure LDAPS and authenticated binds are enforced to avoid info leakage."
  },
  {
    "id": "RULE-MQTT-OPEN",
    "match": { "service_name": "mqtt" },
    "cve": [],
    "severity": "medium",
    "description": "MQTT broker reachable unauthenticated; require TLS and authentication to prevent unauthorized publish/subscribe."
  }
]
